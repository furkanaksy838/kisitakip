sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox"],function(e,t,s,i){"use strict";return e.extend("stajui.project1.controller.View1",{onInit:function(){this.getView().setModel(new t({items:[],visible:false}),"documents")},onFileSelected:function(e){const t=e.getSource();const s=e.getParameter("files")?.[0];if(!s){i.error("Dosya alınamadı!");this._selectedFile=null;return}if(!s.name.toLowerCase().endsWith(".csv")){i.error("Sadece .csv uzantılı dosyalar yüklenebilir!");t.clear();this.byId("filePath").setValue("");this._selectedFile=null;return}const r=s.name;const o="C:\\"+r;this.byId("filePath").setValue(o);this._selectedFile=s},onUpload:function(){const e=this._selectedFile;const t=this.byId("uploadBtn");const r=this.byId("cancelbtn");if(!e){i.error("Lütfen bir .csv dosyası seçin!");t.setEnabled(false);r.setEnabled(false);return}const o=new FileReader;o.onload=e=>{const o=e.target.result;const n=this._parseCSV(o);if(!Array.isArray(n)||n.length===0){i.error("CSV İÇERİĞİ BOŞ VEYA HATALI");return}const l=this.getView().getModel("documents");l.setProperty("/items",n);l.setProperty("/visible",true);s.show("CSV başarıyla yüklendi.");t.setEnabled(true);r.setEnabled(true)};o.readAsText(e)},_parseCSV:function(e){const t=e.trim().split("\n");const s=t[0].split(",");return t.slice(1).map(e=>{const t=e.split(",");const i={};s.forEach((e,s)=>{i[e.trim()]=t[s]?t[s].trim():""});return i}).filter(e=>e.ID&&e.ID.trim()!=="")},onCancel:function(){this.byId("fileUploader").clear();this.byId("filePath").setValue("");this._selectedFile=null;const e=this.getView().getModel("documents");e.setProperty("/items",[]);e.setProperty("/visible",false)},onImport:function(){const e=this.getView().getModel();let t=this.getView().getModel("documents").getProperty("/items");if(!t||t.length===0){i.warning("Import edilecek veri yok!");return}const r=t.some(e=>!e.ID||!e.Name||!e.Birthday||!e.Avatar||!e.Position||!e.HireDate||!e.City);if(r){sap.m.MessageBox.error("Bazı satırlarda eksik bilgi var. Lütfen veriyi kontrol edin.");return}const o=e.bindList("/People");t.forEach(e=>{console.log(e);o.create(e)});localStorage.setItem("importedData",JSON.stringify(t));e.submitBatch("auto").then(()=>{s.show("CSV dosyası kayıt başarıyla gönderildi.");this.getOwnerComponent().getRouter().navTo("success");this.getView().getModel("documents").setProperty("/items",[]);this.byId("filePath").setValue("");const e=this.byId("fileUploader");if(e){e.clear()}}).catch(e=>{i.error("Veriler gönderilirken hata oluştu.");console.error(e)})}})});
//# sourceMappingURL=View1.controller.js.map